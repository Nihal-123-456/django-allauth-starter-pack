{% extends "base.html" %}
{% load i18n %}
{% load socialaccount %}
{% block title %}Social Accounts{% endblock %}
{% block body %}
<div class="flex items-center justify-center h-screen bg-gray-100">
    <div class="w-full max-w-md p-6 bg-white rounded-lg shadow-md">
        <h2 class="text-2xl font-bold text-center text-gray-800 mb-6">Social Accounts</h2>
        {% if form.accounts %}
            <p class="text-sm text-gray-600 mb-4">You can sign in to your account using the following social accounts:</p>
            <form method="POST" action="{% url 'socialaccount_connections' %}" class="space-y-4">
                {% csrf_token %}
                {% include 'snippets/form_error.html' %}
                <ul class="space-y-4">
                    {% for base_account in form.accounts %}
                        {% with account=base_account.get_provider_account %}
                            <li class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <input type="hidden" name="account" value="{{ base_account.id }}" class="w-4 h-4 text-blue-600 bg-gray-200 border-gray-400 rounded focus:ring-blue-500">
                                    <label class="ml-2 text-sm text-gray-900">{{ base_account.get_provider.name }} ({{ account }})</label>
                                </div>
                                <button type="submit" class="text-red-600 hover:underline text-sm">Disconnect</button>
                            </li>
                        {% endwith %}
                    {% endfor %}
                </ul>
            </form>
        {% else %}
            <p class="text-sm text-gray-600 mb-4">You currently have no social accounts connected to this account.</p>
        {% endif %}

        <h3 class="text-xl font-bold text-gray-800 mt-6 mb-4">Connect a Social Account</h3>
        <div class="space-y-4">
            {% get_providers as socialaccount_providers %}
            {% if socialaccount_providers %}
                {% for provider in socialaccount_providers %}
                    <a href="{% provider_login_url provider.id process='connect' %}" class="w-full flex items-center justify-center text-white bg-blue-600 hover:bg-blue-700 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5">
                        Connect with {{ provider.name }}
                    </a>
                {% endfor %}
            {% else %}
                <p class="text-sm text-gray-600">No social account providers are configured. {% if user.is_superuser %}Check the Django admin at <a href="{% url 'admin:socialaccount_socialapplication_changelist' %}" class="text-blue-600 hover:underline">/admin/socialaccount/socialapplication/</a> to configure providers.{% else %}Contact the site administrator to enable social logins.{% endif %}</p>
            {% endif %}
        </div>

        <p class="mt-4 text-sm text-center text-gray-600">
            Back to <a href="{% url 'account_profile' %}" class="text-blue-600 hover:underline">Profile</a>.
        </p>
    </div>
</div>

{% endblock %}